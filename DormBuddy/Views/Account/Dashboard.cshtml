@inject Microsoft.Extensions.Localization.IStringLocalizerFactory LocalizerFactory
@{
    var SharedLocalizer = LocalizerFactory.Create("SharedResource", typeof(Program).Assembly.GetName().Name ?? "");
    ViewData["Title"] = "Dashboard";
}

<div class="dashboard-header text-center">
    <h1 class="display-4">@SharedLocalizer["UserDashboard"]</h1>
    <p>@SharedLocalizer["Welcome"] @ViewBag.Username</p>
    <p id="eventDetails"></p>
</div>

<div class="dashboard-grid">
    <!-- Task Management -->
    <div class="dashboard-card">
        <div class="card-status">
            <div class="status-icon">
                <i class="fas fa-tasks"></i>
            </div>
            <span class="status-badge">@ViewBag.TaskCount Tasks</span>
        </div>
        <div class="card-content">
            <h3 class="card-title">@SharedLocalizer["TaskManagement"]</h3>
            <p class="card-description">@SharedLocalizer["TaskManagementDescription"]</p>
            <a href="/Tasks/Index" class="card-button">@SharedLocalizer["ViewTasks"]</a>
        </div>
    </div>

    <!-- Expense Splitting -->
    <div class="dashboard-card">
        <div class="card-status">
            <div class="status-icon">
                <i class="fas fa-money-bill-wave"></i>
            </div>
            <span class="status-badge">@ViewBag.PendingExpenses Pending</span>
        </div>
        <div class="card-content">
            <h3 class="card-title">@SharedLocalizer["ExpenseSplitting"]</h3>
            <p class="card-description">@SharedLocalizer["ExpenseSplittingDescription"]</p>
            <a href="/Expenses/Index" class="card-button">@SharedLocalizer["ViewExpenses"]</a>
        </div>
    </div>

    <!-- P2P Lending -->
    <div class="dashboard-card">
        <div class="card-status">
            <div class="status-icon">
                <i class="fas fa-handshake"></i>
            </div>
            <span class="status-badge">@ViewBag.LoanStatus</span>
        </div>
        <div class="card-content">
            <h3 class="card-title">@SharedLocalizer["PeerToPeerLending"]</h3>
            <p class="card-description">@SharedLocalizer["PeerToPeerLendingDescription"]</p>
            <a href="/Account/Lending" class="card-button">@SharedLocalizer["ViewLending"]</a>
        </div>
    </div>

    <!-- Account Settings -->
    <div class="dashboard-card">
        <div class="card-status">
            <div class="status-icon">
                <i class="fas fa-user-cog"></i>
            </div>
            <div class="status-badge"></div>
        </div>
        <div class="card-content">
            <h3 class="card-title">@SharedLocalizer["AccountSettings"]</h3>
            <p class="card-description">@SharedLocalizer["AccountSettingsDescription"]</p>
            <a href="/Account/Settings" class="card-button">@SharedLocalizer["ManageAccount"]</a>
        </div>
    </div>

    <!-- Notifications -->
    <div class="dashboard-card">
        <div class="card-status">
            <div class="status-icon">
                <i class="fas fa-bell"></i>
            </div>
            <span class="status-badge">@ViewBag.NewNotifications New</span>
        </div>
        <div class="card-content">
            <h3 class="card-title">@SharedLocalizer["Notifications"]</h3>
            <p class="card-description">@SharedLocalizer["NotificationsDescription"]</p>
            <a href="/Account/Notifications" class="card-button">@SharedLocalizer["ViewNotifications"]</a>
        </div>
    </div>

    <!-- Help & Support -->
    <div class="dashboard-card">
        <div class="card-status">
            <div class="status-icon">
                <i class="fas fa-question-circle"></i>
            </div>
            <div class="status-badge"></div>
        </div>
        <div class="card-content">
            <h3 class="card-title">@SharedLocalizer["HelpAndSupport"]</h3>
            <p class="card-description">@SharedLocalizer["HelpAndSupportDescription"]</p>
            <a href="/Home/ContactUs" class="card-button">@SharedLocalizer["GetHelp"]</a>
        </div>
    </div>

    <!-- Admin Panel - Only shown for admin users -->
    @if (ViewBag.UserRoles.Contains("Admin"))
    {
        <div class="admin-card-container">
            <div class="dashboard-card admin-card">
                <div class="card-status">
                    <div class="status-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <span class="status-badge">Admin</span>
                </div>
                <div class="card-content">
                    <h3 class="card-title">Admin Panel</h3>
                    <p class="card-description">Manage site-wide settings and users.</p>
                    <a href="/Administration/AdminPanel" class="card-button">Go to Admin Panel</a>
                </div>
            </div>
        </div>
    }
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            function updateEventTime() {
                $.get('@Url.Action("GetCurrentTime", "Account")', {}, function(data) {
                    $('#eventDetails').html(data);
                });
            }
            setInterval(updateEventTime, 1000);
            updateEventTime();
        });
    </script>
}
